# Алгоритм Лемпеля-Зива (LZ78)

Алгоритм LZ78 был опубликован в 1978 г как модификация [LZ77](../lz77).



## Описание алгоритма

### Код

Код LZ78 состоит из двух частей:

* **Ссылка на номер символа и словаря** 
* **Символ из исходного сообщения нарушающий последовательность**


## Пример

Пусть дано сообщение `синяя_синева_синеет`


Закодируем, составив таблицу:

| Последовательность | Код | Индекс |
|:------------------:|:---:|:------:|
|                    |     |   0    |

Начнем с того, что запишем в словарь с индексом 0 пустые значения последовательности и кода - сделано это для того, 
чтобы в дальнейшем ссылаться на него, если в словаре не будет найдено нужного символа.


| Последовательность | Код | Индекс |
|:------------------:|:---:|:------:|
|                    |     |   0    |
|         с          | 0с  |   1    |


Далее проходимся по исходному сообщению по символьно. Если символ никогда ранее не встречался в словаре, то 
в коде указываем ссылку на пустую последовательность (в нашем случае индекс) и текущий символ.

Аналогичным образом происходит для символов `и`, `н`, `я`, поскольку они впервые встречаются в словаре:

| Последовательность | Код | Индекс |
|:------------------:|:---:|:------:|
|                    |     |   0    |
|         с          | 0с  |   1    |
|         и          | 0и  |   2    |
|         н          | 0н  |   3    |
|         я          | 0я  |   4    |


На следующем шаге встречаем символ `я`, который уже встречался в словаре. Теперь рассмотрим последовательность из
данного символа и последующего за ним: `я_`. Такая последовательность ранее не встречалась, однако 
встречалась последовательность `я`. Поэтому `_` - символ нарушающий повторяющуюся последовательность.

В столбце последовательность укажем повторяющуюся последовательность вместе с символом который нарушил её

Следовательно, в коде указываем ссылку на последовательность `я` и символ `_`:


| Последовательность | Код | Индекс  |
|:------------------:|:---:|:-------:|
|                    |     |    0    |
|         с          | 0с  |    1    |
|         и          | 0и  |    2    |
|         н          | 0н  |    3    |
|         я          | 0я  |    4    |
|         я_         | 4_  |    5    |


Так как мы закодировали последовательность `я_`, то мы продолжаем обрабатывать исходное сообщение пропуская символ,
который нарушил повторяющуюся последовательность.

Повторяем аналогичные действия для последовательности `си`, `не`, `в`, `а`, `_`:


| Последовательность | Код | Индекс   |
|:------------------:|:---:|:--------:|
|                    |     |    0     |
|         с          | 0с  |    1     |
|         и          | 0и  |    2     |
|         н          | 0н  |    3     |
|         я          | 0я  |    4     |
|         я_         | 4_  |    5     |
|         си         | 1и  |    6     |
|         не         | 3е  |    7     |
|         в          | 0в  |    8     |
|         а          | 0а  |    9     |
|         _          | 0_  |    10    |


На следующем шаге разберем более интересный случай: последовательность из символа `c`, как и последовательность
`си` - уже ранее встречались, однако последовательность `син` - нет. Поэтому `н` - символ нарушающий повторяющуюся 
последовательность => в коде указываем ссылку на последовательность `си` и символ `н`:


| Последовательность | Код | Индекс  |
|:------------------:|:---:|:-------:|
|                    |     |    0    |
|         с          | 0с  |    1    |
|         и          | 0и  |    2    |
|         н          | 0н  |    3    |
|         я          | 0я  |    4    |
|         я_         | 4_  |    5    |
|         си         | 1и  |    6    |
|         не         | 3е  |    7    |
|         в          | 0в  |    8    |
|         а          | 0а  |    9    |
|         _          | 0_  |   10    |
|        син         | 6н  |   11    |


Продолжаем аналогичные действия для последовательности `е`, `ет`:


| Последовательность | Код | Индекс |
|:------------------:|:---:|:------:|
|                    |     |   0    |
|         с          | 0с  |   1    |
|         и          | 0и  |   2    |
|         н          | 0н  |   3    |
|         я          | 0я  |   4    |
|         я_         | 4_  |   5    |
|         си         | 1и  |   6    |
|         не         | 3е  |   7    |
|         в          | 0в  |   8    |
|         а          | 0а  |   9    |
|         _          | 0_  |   10   |
|        син         | 6н  |   11   |
|         е          | 0е  |   12   |
|         ет         | 12т |   13   |


Декодирование происходит обратным образом: по коду находим последовательность в словаре и записываем её в сообщение.
